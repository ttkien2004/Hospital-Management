generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model BacSi {
  BsID                     String    @id(map: "PK__BacSi__5DF790292FD62742") @db.Char(9)
  ChinhNhanhID             Int?
  TenKhoa                  String?   @db.NVarChar(50)
  ChiNhanh                 ChiNhanh? @relation(fields: [ChinhNhanhID], references: [ID], map: "fk_chinhanhid_bacsi")
  NhanVien                 NhanVien  @relation(fields: [BsID], references: [ID], onDelete: Cascade, map: "fk_id_bacsi")
  Khoa_BacSi_TenKhoaToKhoa Khoa?     @relation("BacSi_TenKhoaToKhoa", fields: [TenKhoa], references: [TenKhoa], onDelete: NoAction, onUpdate: NoAction, map: "fk_tenkhoa_bacsi")
  Khoa_Khoa_TKIDToBacSi    Khoa[]    @relation("Khoa_TKIDToBacSi")
}

model Benh {
  MaBenh            String              @id(map: "PK__Benh__DB7E2D49AD72ECBB") @db.Char(9)
  TenBenh           String              @db.NVarChar(50)
  Kham              Kham[]
  TrieuChungCuaBenh TrieuChungCuaBenh[]
}

model BenhNhan {
  ID          String        @id(map: "PK__BenhNhan__3214EC2790DBE7B7") @db.Char(9)
  CCCD        String        @db.NVarChar(12)
  Ho          String        @db.NVarChar(20)
  Ten         String        @db.NVarChar(20)
  NgaySinh    DateTime?     @db.Date
  GioiTinh    String?       @db.Char(1)
  BHYT        String?       @db.Char(9)
  ChieuCao    Decimal?      @db.Decimal(5, 2)
  CanNang     Decimal?      @db.Decimal(5, 2)
  DiUng       DiUng[]
  LanKhamBenh LanKhamBenh[]
}

model ChiNhanh {
  ID            Int             @id(map: "PK__ChiNhanh__3214EC270DE8E47F") @default(autoincrement())
  MaChiNhanh    String?         @db.NVarChar(32)
  DiaChi        String          @db.NVarChar(50)
  BacSi         BacSi[]
  DuocSi        DuocSi[]
  ThuocChiNhanh ThuocChiNhanh[]
  YTa           YTa[]
}

model CoTaiKham {
  BnTaiKhamID                                             String      @db.Char(9)
  NgayKham                                                DateTime    @db.Date
  BnID                                                    String      @db.Char(9)
  NgayTaiKham                                             DateTime    @db.Date
  LanKhamBenh_CoTaiKham_BnID_NgayTaiKhamToLanKhamBenh     LanKhamBenh @relation("CoTaiKham_BnID_NgayTaiKhamToLanKhamBenh", fields: [BnID, NgayTaiKham], references: [BnID, NgayKham], onUpdate: NoAction, map: "fk_kham_cotaikham")
  LanKhamBenh_CoTaiKham_BnTaiKhamID_NgayKhamToLanKhamBenh LanKhamBenh @relation("CoTaiKham_BnTaiKhamID_NgayKhamToLanKhamBenh", fields: [BnTaiKhamID, NgayKham], references: [BnID, NgayKham], onDelete: Cascade, map: "fk_taikham_cotaikham")

  @@id([BnTaiKhamID, NgayKham], map: "PK__CoTaiKha__FB24BAE776C2E442")
  @@unique([BnID, NgayTaiKham], map: "UQ__CoTaiKha__5F5C40AA5B84FD75")
}

model DiUng {
  TenDiUng String   @db.NVarChar(9)
  BnID     String   @db.Char(9)
  BenhNhan BenhNhan @relation(fields: [BnID], references: [ID], onDelete: Cascade, map: "fk_bnid_diung")

  @@id([TenDiUng, BnID], map: "PK__DiUng__C1AD0AFCEFFA612D")
}

model DonThuoc {
  DonID    String @id(map: "PK__DonThuoc__4DA8B408F041E5A8") @db.Char(9)
  DuocSiID String @db.Char(9)
  DuocSi   DuocSi @relation(fields: [DuocSiID], references: [DuocSiID], onDelete: Cascade, map: "fk_duocsiid_donthuoc")
  Gom      Gom[]
}

model DuocMuon {
  ThietBiID    Int
  NvID         String        @db.Char(9)
  NhanVien     NhanVien      @relation(fields: [NvID], references: [ID], onDelete: Cascade, map: "fk_nvid_duocmuon")
  ThietBi      ThietBi       @relation(fields: [ThietBiID], references: [ID], onDelete: Cascade, map: "fk_thietbiid_duocmuon")
  LichSuSuDung LichSuSuDung?

  @@id([ThietBiID, NvID], map: "PK__DuocMuon__0F566612B007BE1C")
}

model DuocSi {
  DuocSiID   String     @id(map: "PK__DuocSi__FB8A93A9AEA421E9") @db.Char(9)
  ChiNhanhID Int?
  DonThuoc   DonThuoc[]
  ChiNhanh   ChiNhanh?  @relation(fields: [ChiNhanhID], references: [ID], map: "fk_chinhanhid_duocsi")
  NhanVien   NhanVien   @relation(fields: [DuocSiID], references: [ID], onDelete: Cascade, map: "fk_id_duocsi")
}

model Gom {
  DonID    String   @db.Char(9)
  MaThuoc  String   @db.Char(9)
  DonThuoc DonThuoc @relation(fields: [DonID], references: [DonID], onDelete: Cascade, map: "fk_donid_gom")
  Thuoc    Thuoc    @relation(fields: [MaThuoc], references: [MaSoThuoc], onDelete: Cascade, map: "fk_mathuoc_gom")

  @@id([DonID, MaThuoc], map: "PK__Gom__5913AB6AC0EF516D")
}

model Kham {
  BnID                  String                 @db.Char(9)
  NgayKham              DateTime               @db.Date
  BsID                  String                 @db.Char(9)
  MaBenh                String?                @db.Char(9)
  LanKhamBenh           LanKhamBenh            @relation(fields: [BnID, NgayKham], references: [BnID, NgayKham], onDelete: Cascade, map: "fk_bnid_kham")
  Benh                  Benh?                  @relation(fields: [MaBenh], references: [MaBenh], map: "fk_mabenh_kham")
  TrieuChungCuaBenhNhan TrieuChungCuaBenhNhan?

  @@id([BnID, NgayKham, BsID], map: "PK__Kham__D1A2F9B13A4402AF")
  @@unique([BnID, NgayKham], map: "UQ__Kham__F9FF0E20EF1DCEC7")
}

model Khoa {
  TenKhoa                   String          @id(map: "PK__Khoa__AAD361597ABE9628") @db.NVarChar(50)
  TKID                      String?         @db.Char(9)
  BacSi_BacSi_TenKhoaToKhoa BacSi[]         @relation("BacSi_TenKhoaToKhoa")
  BacSi_Khoa_TKIDToBacSi    BacSi?          @relation("Khoa_TKIDToBacSi", fields: [TKID], references: [BsID], map: "fk_truongkhoaid_khoa")
  ThuocChiNhanh             ThuocChiNhanh[]
  YTa                       YTa[]
}

model LanKhamBenh {
  BnID                                                  String     @db.Char(9)
  NgayKham                                              DateTime   @db.Date
  ChiSoSucKhoe                                          String     @db.NVarChar(50)
  DonThuocID                                            String?    @db.Char(9)
  YtaID                                                 String?    @db.Char(9)
  CoTaiKham_CoTaiKham_BnID_NgayTaiKhamToLanKhamBenh     CoTaiKham? @relation("CoTaiKham_BnID_NgayTaiKhamToLanKhamBenh")
  CoTaiKham_CoTaiKham_BnTaiKhamID_NgayKhamToLanKhamBenh CoTaiKham? @relation("CoTaiKham_BnTaiKhamID_NgayKhamToLanKhamBenh")
  Kham                                                  Kham?
  BenhNhan                                              BenhNhan   @relation(fields: [BnID], references: [ID], onDelete: Cascade, map: "fk_bnid_lankhambenh")
  YTa                                                   YTa?       @relation(fields: [YtaID], references: [YtaID], map: "fk_ytaid_lankhambenh")

  @@id([BnID, NgayKham], map: "PK__LanKhamB__F9FF0E21D5E44F68")
}

model LichSuSuDung {
  ThietBiID    Int
  NhanVienID   String    @db.Char(9)
  LssdID       String    @db.Char(9)
  ThoiGianMuon DateTime? @db.Date
  ThoiGianTra  DateTime? @db.Date
  DuocMuon     DuocMuon  @relation(fields: [ThietBiID, NhanVienID], references: [ThietBiID, NvID], onDelete: Cascade, map: "fk_thietbiid_lichsusudung")

  @@id([ThietBiID, NhanVienID, LssdID], map: "PK__LichSuSu__8D2A51E4BB159836")
  @@unique([ThietBiID, NhanVienID], map: "UQ__LichSuSu__5606FA9C1416DFA5")
}

model Nhan {
  NvID     String   @db.Char(9)
  TbID     String   @db.Char(9)
  DaNhan   Boolean  @default(false, map: "DF__Nhan__DaNhan__68487DD7")
  NhanVien NhanVien @relation(fields: [NvID], references: [ID], onDelete: Cascade, map: "fk_nvid_nhan")
  ThongBao ThongBao @relation(fields: [TbID], references: [ID], onUpdate: NoAction, map: "fk_tbid_nhan")

  @@id([NvID, TbID], map: "PK__Nhan__AF95101D62D45CE1")
}

model NhanVien {
  ID          String       @id(map: "PK__NhanVien__3214EC272F46A01C") @db.Char(9)
  Ho          String       @db.NVarChar(50)
  TEN         String       @db.NVarChar(50)
  CCCD        String       @unique(map: "UQ__NhanVien__A955A0AA8EBCF698") @db.NVarChar(12)
  NgaySinh    DateTime?    @db.Date
  GioiTinh    String?      @db.Char(1)
  Email       String?      @db.NVarChar(50)
  NgayBatDau  DateTime?    @db.Date
  Sdt1        String?      @db.Char(10)
  Sdt2        String?      @db.Char(10)
  BacSi       BacSi?
  DuocMuon    DuocMuon[]
  DuocSi      DuocSi?
  Nhan        Nhan[]
  QuanTriVien QuanTriVien?
  YTa         YTa?
}

model QuanTriVien {
  QtvID    String     @id(map: "PK__QuanTriV__5C62712921E34F5F") @db.Char(9)
  NhanVien NhanVien   @relation(fields: [QtvID], references: [ID], onDelete: Cascade, map: "fk_qtvid_quantrivien")
  ThongBao ThongBao[]
}

model ThietBi {
  ID        Int        @id(map: "PK__ThietBi__3214EC2743FB76F0") @default(autoincrement())
  Ten       String     @db.NVarChar(20)
  TinhTrang String     @db.NVarChar(20)
  Phong     String?    @db.NVarChar(20)
  DuocMuon  DuocMuon[]
}

model ThongBao {
  ID          String      @id(map: "PK__ThongBao__3214EC27AC61EB2A") @db.Char(9)
  QtvID       String      @db.Char(9)
  TieuDe      String      @db.NVarChar(100)
  NoiDung     String      @db.NVarChar(200)
  ThoiGian    DateTime?   @db.DateTime
  Nhan        Nhan[]
  QuanTriVien QuanTriVien @relation(fields: [QtvID], references: [QtvID], onDelete: Cascade, map: "fk_id_thongbao")
}

model Thuoc {
  MaSoThuoc      String   @id(map: "PK__Thuoc__FE2849C05B82CEE6") @db.Char(9)
  Ten            String   @db.NVarChar(50)
  GiaNhap        Decimal? @db.Decimal(10, 2)
  GiaBan         Decimal? @db.Decimal(10, 2)
  HuongDanSuDung String?  @db.NVarChar(100)
  HanSuDung      DateTime @db.Date
  ChongChiDinh   String?  @db.NVarChar(50)
  XuatXu         String?  @db.NVarChar(50)
  Tong           Int?
  TonKho         Int?
  Gom            Gom[]
}

model ThuocChiNhanh {
  ChinhNhanhID Int
  TenKhoa      String   @db.NVarChar(50)
  ChiNhanh     ChiNhanh @relation(fields: [ChinhNhanhID], references: [ID], onDelete: Cascade, map: "fk_chinhanhid_thuocchinhanh")
  Khoa         Khoa     @relation(fields: [TenKhoa], references: [TenKhoa], onUpdate: NoAction, map: "fk_tenkhoa_thuocchinhanh")

  @@id([ChinhNhanhID, TenKhoa], map: "PK__ThuocChi__A3FC855BFBF747D6")
}

model TrieuChungCuaBenh {
  MaBenh         String @db.Char(9)
  TrieuChungBenh String @db.NVarChar(50)
  Benh           Benh   @relation(fields: [MaBenh], references: [MaBenh], onDelete: Cascade, map: "fk_mabenh_trieuchungbenh")

  @@id([MaBenh, TrieuChungBenh], map: "PK__TrieuChu__7D456D7CE22677CC")
}

model TrieuChungCuaBenhNhan {
  BnID       String   @db.Char(9)
  NgayKham   DateTime @db.Date
  BsID       String   @db.Char(9)
  TrieuChung String   @db.NVarChar(50)
  Kham       Kham     @relation(fields: [BnID, NgayKham, BsID], references: [BnID, NgayKham, BsID], onDelete: Cascade, map: "fk_id_trieuchungcuabenhnhan")

  @@id([BnID, NgayKham, BsID, TrieuChung], map: "PK__TrieuChu__96808A8ACAD99894")
  @@unique([BnID, NgayKham, BsID], map: "UQ__TrieuChu__D1A2F9B09B14B9AB")
}

model YTa {
  YtaID        String        @id(map: "PK__YTa__A3C3FF61A558B8FF") @db.Char(9)
  ChinhNhanhID Int?
  TenKhoa      String?       @db.NVarChar(50)
  LanKhamBenh  LanKhamBenh[]
  ChiNhanh     ChiNhanh?     @relation(fields: [ChinhNhanhID], references: [ID], map: "fk_chinhanhid_yta")
  Khoa         Khoa?         @relation(fields: [TenKhoa], references: [TenKhoa], onDelete: NoAction, onUpdate: NoAction, map: "fk_tenkhoa_yta")
  NhanVien     NhanVien      @relation(fields: [YtaID], references: [ID], onDelete: Cascade, map: "fk_ytaid_yta")
}
